---
layout: post
status: publish
published: true
title: Xorg, ma che mi combini?
author:
  display_name: Bl@ster
  login: Blaster
  email: dottorblaster@gmail.com
  url: http://www.dottorblaster.it
author_login: Blaster
author_email: dottorblaster@gmail.com
author_url: http://www.dottorblaster.it
wordpress_id: 243
wordpress_url: http://dottorblaster.it/?p=243
date: '2008-12-08 22:14:42 +0100'
date_gmt: '2008-12-08 21:14:42 +0100'
categories:
- Linux
- How-To
- Tech
tags:
- Informatica
- Arch
comments:
- id: 5835
  author: paolo
  author_email: lasolita@aaa.com
  author_url: http://www.polslinux.wordpress.com
  date: '2008-12-09 18:33:57 +0100'
  date_gmt: '2008-12-09 17:33:57 +0100'
  content: "io invece ero per il classico xorg.conf!\r\n\r\nmi sta un po' qua sto
    metodo....anche perchè il mio touchpad non è più quello di una volta :("
- id: 5836
  author: pierluigi
  author_email: pierluigi.picciau@gmail.com
  author_url: http://pierloz.com
  date: '2008-12-09 21:02:34 +0100'
  date_gmt: '2008-12-09 20:02:34 +0100'
  content: "eh, dopo aver rinviato il \"pacman -Syu\" per qualche giorno, 48 ore fa
    mi son deciso a mettere da parte la pigrizia e combattere con questo nuovo xorg.\r\n\r\nVabbè,
    ho buttato mezz'ora di sonno per passare alla configurazione con hotplug, funziona
    circa come prima.\r\nIl touchpad ha una sensibilità un po' diversa.\r\nCopiare
    i valori che avevo in precedenza nei nuovi file di hal non è servito a molto,
    anzi ho dovuto ritoccarli.\r\n\r\nPazienza, mi son detto, l'evoluzione passa per
    un po' di fatica :)"
- id: 5837
  author: Bl@ster
  author_email: dottorblaster@gmail.com
  author_url: http://www.dottorblaster.it
  date: '2008-12-09 22:05:29 +0100'
  date_gmt: '2008-12-09 21:05:29 +0100'
  content: "@paolo: Mah, a me non ha fatto nè bene nè male. Devo rifinire anche il
    file della tastiera, che ora come ora alcune funzioni speciali, anche se funzionanti,
    fanno una sorta di doppio mestiere.\r\n\r\n@pierluigi: Certamente, comunque io
    nel post non l'ho detto ma penso che poi con l'andar del (poco) tempo chi rimane
    senza hotplugging sarà escluso da parecchie feature ;)\r\nAdesso Xorg può abusare
    di hal :P"
- id: 5868
  author: telperion
  author_email: nikita_top@libero.it
  author_url: ''
  date: '2008-12-17 23:41:56 +0100'
  date_gmt: '2008-12-17 22:41:56 +0100'
  content: "Ma gli costava tanto inserire un programmino da shell che generava, previo
    input a domande e lettura dell'xorg.conf, i necessari file .fdi per le periferiche
    in uso? \r\nA volte mi sembra che a qualcuno manchi ...\r\nIo comunque disattivo
    hotplugging per me di nessuna utilità, la tastiera e il mouse quelli sono, e non
    ho alcuna necessità di attaccarne altri a caldo.\r\nBoh boh e triplo boh.\r\n\r\nAh
    anche un tool decente (a riga di comando) per configurare risoluzione e frequenze
    del monitor non farebbe poi cosi schifo."
- id: 14476
  author: paolo
  author_email: lasolita@aaa.com
  author_url: http://www.polslinux.wordpress.com
  date: '2008-12-09 17:33:00 +0100'
  date_gmt: '2008-12-09 17:33:00 +0100'
  content: "io invece ero per il classico xorg.conf!\r\n\r\nmi sta un po' qua sto
    metodo....anche perchè il mio touchpad non è più quello di una volta :("
- id: 14477
  author: pierluigi
  author_email: pierluigi.picciau@gmail.com
  author_url: http://pierloz.com
  date: '2008-12-09 20:02:00 +0100'
  date_gmt: '2008-12-09 20:02:00 +0100'
  content: "eh, dopo aver rinviato il \"pacman -Syu\" per qualche giorno, 48 ore fa
    mi son deciso a mettere da parte la pigrizia e combattere con questo nuovo xorg.\r\n\r\nVabbè,
    ho buttato mezz'ora di sonno per passare alla configurazione con hotplug, funziona
    circa come prima.\r\nIl touchpad ha una sensibilità un po' diversa.\r\nCopiare
    i valori che avevo in precedenza nei nuovi file di hal non è servito a molto,
    anzi ho dovuto ritoccarli.\r\n\r\nPazienza, mi son detto, l'evoluzione passa per
    un po' di fatica :)"
- id: 14478
  author: Bl@ster
  author_email: dottorblaster@gmail.com
  author_url: http://dottorblaster.it/
  date: '2008-12-09 21:05:00 +0100'
  date_gmt: '2008-12-09 21:05:00 +0100'
  content: "@paolo: Mah, a me non ha fatto nè bene nè male. Devo rifinire anche il
    file della tastiera, che ora come ora alcune funzioni speciali, anche se funzionanti,
    fanno una sorta di doppio mestiere.\r\n\r\n@pierluigi: Certamente, comunque io
    nel post non l'ho detto ma penso che poi con l'andar del (poco) tempo chi rimane
    senza hotplugging sarà escluso da parecchie feature ;)\r\nAdesso Xorg può abusare
    di hal :P"
- id: 14479
  author: telperion
  author_email: nikita_top@libero.it
  author_url: ''
  date: '2008-12-17 22:41:00 +0100'
  date_gmt: '2008-12-17 22:41:00 +0100'
  content: "Ma gli costava tanto inserire un programmino da shell che generava, previo
    input a domande e lettura dell'xorg.conf, i necessari file .fdi per le periferiche
    in uso? \r\nA volte mi sembra che a qualcuno manchi ...\r\nIo comunque disattivo
    hotplugging per me di nessuna utilità, la tastiera e il mouse quelli sono, e non
    ho alcuna necessità di attaccarne altri a caldo.\r\nBoh boh e triplo boh.\r\n\r\nAh
    anche un tool decente (a riga di comando) per configurare risoluzione e frequenze
    del monitor non farebbe poi cosi schifo."
---
<p>Leggendo il forum di ArchLinux, come pure i vari messaggi d'aiuto inviati sul canale #archlinux, ci si può rendere subito conto che il rilascio del nuovo Xorg 1.5.3 ha portato prevalentemente crisi nel mondo ArchLinux e Linux in generale.</p>
<p>Questo fenomeno di panico generale è dovuto alla nuova feature di hotplugging, con la quale Xorg si occupa solamente di gestire l'output a video; l'input non viene più gestito dai vecchi driver, ma attraverso il nuovo driver evdev Xorg delega tutto ciò che riguarda mouse, tastiera e touchpad ad HAL.</p>
<p style="text-align: center;"><img class="alignnone" src="http://i37.tinypic.com/2uif24k.png" alt="" width="431" height="345" /></p>
<p>In questo modo viene reso possibile il riconoscimento "a caldo" di parecchi dispositivi come tastiere o mouse particolari, ma di contro possiamo accorgerci di come una configurazione minimale risenta tantissimo di questa nuova peculiarità: le strade possibili sono due, dunque.</p>
<p>La prima consiste nell'aggiungere in coda al nostro xorg.conf le seguenti righe:</p>
<p><code>Section "ServerFlags"<br />
Option "AutoAddDevices" "False"<br />
EndSection</code></p>
<p>con le quali possiamo disabilitare l'hotplugging.</p>
<p>Dal canto mio, però, non posso che consigliare la seconda via, ovvero configurare per benino hal in quanto, essendo presente la funzione di hotplugging, non vedo motivi per non usarla; e seguendo questo semplice procedimento, ci accorgeremo che la configurazione di HAL per quanto riguarda l'input è relativamente semplice.</p>
<p>Andiamo ad editare /etc/hal/fdi/policy/10-keymap.fdi, con qualunque editor, sia esso gedit, nano, vi o emacs; all'interno di questo file, per ora vuoto, incolliamo tutto ciò:</p>
<blockquote><p><code>&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt; &lt;!-- -*- SGML -*- --&gt;<br />
&lt;deviceinfo version="0.2"&gt;<br />
&lt;device&gt;<br />
&lt;match key="info.capabilities" contains="input.keymap"&gt;<br />
&lt;append key="info.callouts.add" type="strlist"&gt;hal-setup-keymap&lt;/append&gt;<br />
&lt;/match&gt;</code></p>
<p><code>&lt;match key="info.capabilities" contains="input.keys"&gt;<br />
&lt;merge key="input.xkb.rules" type="string"&gt;base&lt;/merge&gt;</code></p>
<p><code>&lt;!-- If we're using Linux, we use evdev by default (falling back to<br />
keyboard otherwise).<br />
&lt;merge key="input.xkb.model" type="string"&gt;kbd&lt;/merge&gt;--&gt;<br />
&lt;match key="/org/freedesktop/Hal/devices/computer:system.kernel.name"<br />
string="Linux"&gt;<br />
&lt;merge key="input.xkb.model" type="string"&gt;evdev&lt;/merge&gt;<br />
&lt;/match&gt;<br />
&lt;merge key="input.xkb.layout" type="string"&gt;it&lt;/merge&gt;<br />
&lt;/match&gt;<br />
&lt;/device&gt;<br />
&lt;/deviceinfo&gt;</code></p></blockquote>
<p>Salviamo, riavviamo il sistema (per riavviare in modo facile sia HAL che Xorg), e andiamo a spiegare cosa dicono le righe appena incollate: quello proposto da me è semplicemente un file di esempio per far funzionare, almeno in partenza, la tastiera, senza incappare in brutti problemi di localizzazione.</p>
<p>Sia chiaro, quelle righe postate poco sopra non sono la soluzione a tutti i mali; anzi, è raccomandato da parte mia analizzarne il contenuto e ottimizzare la configurazione per quanto riguarda il proprio hardware.</p>
<p>Con il nuovo Xorg è cambiata anche la maniera di gestire il touchpad, che viene gestito sempre attraverso il nostro amatissimo/odiatissimo (fate vobis, dipende dai punti di vista) HAL. Anche per il touchpad bastano poche righe nell'apposito file <em>/etc/hal/fdi/policy/11-x11-synaptics.fdi</em>, anch'esso da editare con l'editor di testo puro che preferiamo. Le righe che renderanno il touchpad funzionante al meglio, con scrolling laterale abilitato e tap-click, sono queste:</p>
<blockquote><p><code>&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;<br />
&lt;deviceinfo version="0.2"&gt;<br />
&lt;device&gt;<br />
&lt;match key="info.capabilities" contains="input.touchpad"&gt;<br />
&lt;match key="info.product" contains="Synaptics TouchPad"&gt;<br />
&lt;merge key="input.x11_driver" type="string"&gt;synaptics&lt;/merge&gt;<br />
&lt;!-- Arbitrary options can be passed to the driver using<br />
the input.x11_options property since xorg-server-1.5. --&gt;<br />
&lt;!-- EXAMPLE:<br />
&lt;merge key="input.x11_options.LeftEdge" type="string"&gt;120&lt;/merge&gt;<br />
--&gt;<br />
&lt;/match&gt;<br />
&lt;!--     &lt;match key="info.product" contains="AlpsPS/2 ALPS"&gt;<br />
&lt;merge key="input.x11_driver" type="string"&gt;synaptics&lt;/merge&gt;<br />
&lt;/match&gt;<br />
&lt;match key="info.product" contains="appletouch"&gt;<br />
&lt;merge key="input.x11_driver" type="string"&gt;synaptics&lt;/merge&gt;<br />
&lt;/match&gt;<br />
&lt;match key="info.product" contains="bcm5974"&gt;<br />
&lt;merge key="input.x11_driver" type="string"&gt;synaptics&lt;/merge&gt;<br />
&lt;/match&gt;--&gt;<br />
&lt;!--<br />
&lt;merge key="input.x11_options.touchpadoff" type="string"&gt;0&lt;/merge&gt;<br />
&lt;merge key="input.x11_options.shmconfig" type="string"&gt;on&lt;/merge&gt;--&gt;<br />
&lt;merge key="input.x11_options.TapButton1" type="string"&gt;1&lt;/merge&gt;<br />
&lt;merge key="input.x11_options.TapButton2" type="string"&gt;2&lt;/merge&gt;<br />
&lt;merge key="input.x11_options.TapButton3" type="string"&gt;3&lt;/merge&gt;<br />
&lt;merge key="input.x11_options.protocol" type="string"&gt;event&lt;/merge&gt;<br />
&lt;merge key="input.x11_options.vertedgescroll" type="string"&gt;true&lt;/merge&gt;<br />
&lt;merge key="input.x11_options.horizedgescroll" type="string"&gt;true&lt;/merge&gt;<br />
&lt;merge key="input.x11_options.RightEdge" type="string"&gt;5300&lt;/merge&gt;<br />
&lt;merge key="input.x11_options.LeftEdge" type="string"&gt;1700&lt;/merge&gt;<br />
&lt;merge key="input.x11_options.BottomEdge" type="string"&gt;4200&lt;/merge&gt;<br />
&lt;merge key="input.x11_options.TopEdge" type="string"&gt;1700&lt;/merge&gt;<br />
&lt;!--&lt;merge key="input.x11_options.VertTwoFingerScroll" type="string"&gt;true&lt;/merge&gt;<br />
&lt;merge key="input.x11_options.HorizTwoFingerScroll" type="string"&gt;true&lt;/merge&gt; --&gt;<br />
&lt;merge key="input.x11_options.VertScrollDelta" type="string"&gt;100&lt;/merge&gt;<br />
&lt;/match&gt;<br />
&lt;/device&gt;<br />
&lt;/deviceinfo&gt;</code></p></blockquote>
<p>Ovviamente, cancelliamo le righe che riguardano lo scrolling se non abbiamo un touchpad che supporta lo scrolling laterale.</p>
<p>E dopo la piccola guida su come raccapezzarsi nel nuovo metodo di input di Xorg, andiamo a dare anche qualche critica.</p>
<p>C'è chi amava la configurazione statica attraverso Xorg.conf, c'è chi odiava questo file pieno di righe incomprensibili ai più; io dico la mia, avendo avuto un rapporto con il file xorg.conf di tipo odi et amo.</p>
<p>Apprezzo molto il nuovo metodo di input. In questo periodo mi sto occupando della diffusione di GNU/Linux verso l'utenza di massa, e questo non è esattamente il modo giusto per portare il pinguino nelle case degli italiani: una delle cose di cui l'utente medio è spaventato è l'editing dell'xorg.conf, o di altri file. Diciamo pure che ritengo queste nuove modifiche molto neutrali, da questo punto di vista, nel senso che il niubbo completo non troverebbe molta differenza tra il non capire nulla di xorg.conf e il non capire nulla dei file di configurazione di HAL. Credo che però sviluppando una buona GUI che si occupi di togliere, inserire e cambiare le linee nei due file che abbiamo editato precedentemente, possa essere un buon passo per far avvicinare l'utente medio al mondo del pinguino, senza dover per forza fargli usare una riga di comando.</p>
<p>Un plauso speciale a tutti coloro che scrivono di ArchLinux e che sono aggregati sul <a href="http://www.archlinux.it/planet/">Planet</a>, i quali hanno analizzato la nuova struttura di Xorg prima di me, hanno tratto le debite conclusioni e fatto qualche simil-guida. Da tutti i loro post ho preso spunto per scrivere il mio, che in qualche modo è solo una somma di cose già dette, più qualche piccola aggiunta personale.</p>
